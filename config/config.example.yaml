# GitHub Year-End Report Configuration
# Copy this file to config.yaml and customize for your org/user
#
# Quick Start:
#   1. cp config/config.example.yaml config/config.yaml
#   2. Edit github.target.name to your org/username
#   3. Set GITHUB_TOKEN environment variable
#   4. Run: uv run gh-year-end all --config config/config.yaml

github:
  target:
    mode: org              # org | user - analyze organization or personal account
    name: example-org      # Organization or username to analyze
  auth:
    token_env: GITHUB_TOKEN  # Environment variable containing GitHub token
  discovery:
    include_forks: false     # Include forked repositories
    include_archived: false  # Include archived repositories
    visibility: all          # all | public | private
  windows:
    year: 2025
    since: "2025-01-01T00:00:00Z"
    until: "2026-01-01T00:00:00Z"

rate_limit:
  strategy: adaptive         # adaptive | fixed
  max_concurrency: 4         # Max parallel requests (increase for faster collection)
  min_sleep_seconds: 1       # Minimum sleep between requests
  max_sleep_seconds: 60      # Maximum sleep when rate limited
  sample_rate_limit_endpoint_every_n_requests: 50
  burst:
    capacity: 30             # Maximum burst capacity
    sustained_rate: 10.0     # Sustained tokens per second
    recovery_rate: 2.0       # Token recovery rate per second
  secondary:
    max_requests_per_minute: 90    # GitHub secondary rate limit threshold
    detection_window_seconds: 60   # Detection window
    backoff_multiplier: 1.5        # Backoff multiplier on violations
    threshold: 0.8                 # Percentage of limit to trigger throttling
    max_backoff_multiplier: 2.0    # Maximum backoff multiplier cap

identity:
  bots:
    exclude_patterns:
      - ".*\\[bot\\]$"        # GitHub App bots
      - "^dependabot$"        # Dependabot
      - "^renovate\\[bot\\]$" # Renovate bot
    include_overrides: []     # Force-include specific bot accounts as humans
  humans_only: true           # Filter bots from leaderboards

collection:
  enable:
    pulls: true      # Pull requests
    issues: true     # Issues (non-PR)
    reviews: true    # PR reviews
    comments: true   # Issue and review comments
    commits: true    # Commits
    hygiene: true    # Repository hygiene checks
  commits:
    include_files: true    # Include file changes in commits
    classify_files: true   # Classify files (docs, test, ci, etc.)
    max_per_repo: null     # Limit to N commits per repo (null = no limit)
    max_pages: null        # Limit to N pages per repo (null = no limit)
    since_days: null       # Only commits from last N days (null = full window)
  hygiene:
    paths:
      - "SECURITY.md"
      - "README.md"
      - "LICENSE"
      - "CONTRIBUTING.md"
      - "CODE_OF_CONDUCT.md"
      - "CODEOWNERS"
      - ".github/CODEOWNERS"
    workflow_prefixes:
      - ".github/workflows/"
    branch_protection:
      mode: sample           # skip | best_effort | sample
      sample_top_repos_by: prs_merged
      sample_count: 25
    security_features:
      best_effort: true

storage:
  root: "./data"
  raw_format: jsonl
  curated_format: parquet
  dataset_version: "v1"

report:
  title: "Year in Review 2025"              # Page title
  output_dir: "./site"                       # Output directory for static site
  theme: "engineer_exec_toggle"              # Theme selection
  awards_config: "./config/awards.yaml"      # Custom awards configuration

  # GitHub Pages deployment settings (required for subpath deployment)
  base_path: ""                              # URL path prefix (e.g., "/your-repo-name")
  base_url: ""                               # Full site URL (e.g., "https://org.github.io/repo")

  # Display settings
  organization_name: ""                      # Display name (defaults to github.target.name)
  description: "GitHub Year in Review - Community health metrics and statistics"
  theme_color: "#667eea"                     # PWA theme color

# Analysis thresholds (all values are customizable)
thresholds:
  # Hygiene score thresholds (0-100)
  hygiene_healthy: 50      # Score >= this is healthy (green)
  hygiene_warning: 30      # Score >= this is warning (yellow), below is critical (red)
  hygiene_good: 60         # Good threshold for trend indicators
  hygiene_bad: 40          # Bad threshold for trend indicators

  # Review thresholds
  review_coverage_good: 50       # Good review coverage percentage
  review_coverage_bad: 20        # Poor review coverage percentage
  max_review_time_hours: 48      # Target max time to first review

  # PR thresholds
  stale_pr_days: 30              # Days before PR is considered stale
  high_pr_ratio: 0.5             # High PR merge ratio threshold

  # Display limits
  leaderboard_top_n: 10          # Number of entries in leaderboards
  contributor_chart_top_n: 10    # Number of contributors in charts
