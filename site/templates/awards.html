{% extends "base.html" %}

{% block title %}{{ config.report.title }} - Awards{% endblock %}
{% block nav_awards %}active{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Awards & Recognition</h1>
    <p class="lead">Celebrating achievements and highlighting opportunities</p>
</div>

<section class="awards-hero-section">
    <div class="hero-banner">
        <h2>{{ config.github.windows.year }} Community Champions</h2>
        <p>Recognizing outstanding contributions and memorable moments</p>
    </div>
</section>

<section class="awards-tabs-section">
    <div class="tabs">
        <button class="tab-button active" data-tab="individual">Individual Awards</button>
        <button class="tab-button" data-tab="repository">Repository Awards</button>
        <button class="tab-button" data-tab="risk">Risk Signals</button>
    </div>

    <!-- Individual Awards Tab -->
    <div class="tab-content active" id="tab-individual">
        <div class="awards-grid">
            {% for award in awards.individual %}
            <div class="award-card award-{{ award.award_key }}">
                <div class="award-icon">
                    <svg width="48" height="48" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M9.669.864 8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68L9.669.864zm1.196 1.193.684 1.365 1.086 1.072L12.387 6l.248 1.506-1.086 1.072-.684 1.365-1.51.229L8 10.874l-1.355-.702-1.51-.229-.684-1.365-1.086-1.072L3.614 6l-.25-1.506 1.087-1.072.684-1.365 1.51-.229L8 1.126l1.356.702 1.509.229z"/>
                        <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                    </svg>
                </div>
                <div class="award-header">
                    <h3 class="award-title">{{ award.title }}</h3>
                    <p class="award-description">{{ award.description }}</p>
                </div>
                <div class="award-winner">
                    <div class="winner-avatar">
                        <img src="{{ award.winner_avatar_url | default('https://github.com/identicons/' + award.winner_name + '.png') }}"
                             alt="{{ award.winner_name }}">
                    </div>
                    <div class="winner-info">
                        <a href="https://github.com/{{ award.winner_name }}"
                           target="_blank"
                           rel="noopener noreferrer"
                           class="winner-name">
                            {{ award.winner_name }}
                        </a>
                        <div class="winner-stats">
                            {% if award.supporting_stats %}
                            {{ award.supporting_stats }}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Repository Awards Tab -->
    <div class="tab-content" id="tab-repository">
        <div class="awards-grid">
            {% for award in awards.repository %}
            <div class="award-card award-{{ award.award_key }}">
                <div class="award-icon">
                    <svg width="48" height="48" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 1 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 0 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5v-9zm10.5-1V9h-8c-.356 0-.694.074-1 .208V2.5a1 1 0 0 1 1-1h8z"/>
                    </svg>
                </div>
                <div class="award-header">
                    <h3 class="award-title">{{ award.title }}</h3>
                    <p class="award-description">{{ award.description }}</p>
                </div>
                <div class="award-winner repo-winner">
                    <div class="winner-info">
                        <a href="https://github.com/{{ award.repo_name }}"
                           target="_blank"
                           rel="noopener noreferrer"
                           class="winner-name">
                            {{ award.repo_name }}
                        </a>
                        <div class="winner-stats">
                            {% if award.supporting_stats %}
                            {{ award.supporting_stats }}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Risk Signals Tab -->
    <div class="tab-content" id="tab-risk">
        <div class="risk-signals-grid">
            {% if risks and risks|length > 0 %}
            {% for risk in risks[:6] %}
            <div class="risk-signal-card risk-{{ risk.severity }}">
                <div class="risk-signal-header">
                    <div class="risk-signal-icon">
                        <svg width="32" height="32" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                        </svg>
                    </div>
                    <div class="risk-signal-info">
                        <h3 class="risk-signal-title">{{ risk.title }}</h3>
                        <span class="risk-badge risk-badge-{{ risk.severity }}">{{ risk.severity | upper }}</span>
                    </div>
                </div>
                <p class="risk-signal-description">{{ risk.description }}</p>
                {% if risk.affected_repos %}
                <div class="risk-signal-stats">
                    <div class="risk-stat">
                        <span class="risk-stat-label">Affected Repositories:</span>
                        <span class="risk-stat-value">{{ risk.affected_repos | length }}</span>
                    </div>
                    <div class="risk-affected-list">
                        {% for repo in risk.affected_repos[:5] %}
                        <span class="risk-affected-item">{{ repo }}</span>
                        {% endfor %}
                        {% if risk.affected_repos|length > 5 %}
                        <span class="risk-affected-more">+{{ risk.affected_repos|length - 5 }} more</span>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
                {% if risk.recommendation %}
                <div class="risk-recommendation">
                    <strong>Recommendation:</strong> {{ risk.recommendation }}
                </div>
                {% endif %}
            </div>
            {% endfor %}
            {% else %}
            <div class="empty-state">
                <p>No risk signals detected. Great job maintaining healthy repositories!</p>
            </div>
            {% endif %}
        </div>
    </div>
</section>

<section class="special-mentions-section">
    <h2>Special Mentions</h2>
    <div class="mentions-grid">
        <div class="mention-card">
            <h3>First Contribution</h3>
            <p>Celebrating new community members</p>
            <div class="mention-list">
                {% if special_mentions.first_contributions and special_mentions.first_contributions|length > 0 %}
                {% for contributor in special_mentions.first_contributions[:5] %}
                <div class="mention-item">
                    <img src="{{ contributor.avatar_url | default('https://github.com/identicons/' + contributor.user + '.png') }}"
                         alt="{{ contributor.user }}"
                         class="mini-avatar">
                    <a href="https://github.com/{{ contributor.user }}"
                       target="_blank"
                       rel="noopener noreferrer">
                        {{ contributor.user }}
                    </a>
                </div>
                {% endfor %}
                {% else %}
                <p class="empty-mention">No first-time contributors this period</p>
                {% endif %}
            </div>
        </div>

        <div class="mention-card">
            <h3>Consistent Contributors</h3>
            <p>Most weeks with activity</p>
            <div class="mention-list">
                {% if special_mentions.consistent_contributors and special_mentions.consistent_contributors|length > 0 %}
                {% for contributor in special_mentions.consistent_contributors[:3] %}
                <div class="mention-item">
                    <img src="{{ contributor.avatar_url | default('https://github.com/identicons/' + contributor.user + '.png') }}"
                         alt="{{ contributor.user }}"
                         class="mini-avatar">
                    <a href="https://github.com/{{ contributor.user }}"
                       target="_blank"
                       rel="noopener noreferrer">
                        {{ contributor.user }}
                    </a>
                    <span class="mention-stat">{{ contributor.weeks }} weeks</span>
                </div>
                {% endfor %}
                {% else %}
                <p class="empty-mention">Data not available</p>
                {% endif %}
            </div>
        </div>

        <div class="mention-card">
            <h3>Largest PR</h3>
            <p>Biggest single contribution</p>
            <div class="mention-list">
                {% for pr in special_mentions.largest_prs[:5] %}
                <div class="mention-item">
                    <img src="{{ pr.author_avatar_url | default('https://github.com/identicons/' + pr.author_login + '.png') }}"
                         alt="{{ pr.author_login }}"
                         class="mini-avatar">
                    <div class="mention-info">
                        <a href="{{ pr.url }}"
                           target="_blank"
                           rel="noopener noreferrer">
                            {{ pr.title | truncate(40) }}
                        </a>
                        <span class="mention-stat">{{ pr.lines_changed }} lines</span>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="mention-card">
            <h3>Fastest Merge</h3>
            <p>Quickest time from open to merge</p>
            <div class="mention-list">
                {% for pr in special_mentions.fastest_merges[:5] %}
                <div class="mention-item">
                    <img src="{{ pr.author_avatar_url | default('https://github.com/identicons/' + pr.author_login + '.png') }}"
                         alt="{{ pr.author_login }}"
                         class="mini-avatar">
                    <div class="mention-info">
                        <a href="{{ pr.url }}"
                           target="_blank"
                           rel="noopener noreferrer">
                            {{ pr.title | truncate(40) }}
                        </a>
                        <span class="mention-stat">{{ pr.merge_time }}</span>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<section class="fun-facts-section">
    <h2>Fun Facts</h2>
    <div class="fun-facts-grid">
        {% if fun_facts.busiest_day %}
        <div class="fun-fact-card">
            <div class="fun-fact-icon">
                <svg width="32" height="32" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5z"/>
                </svg>
            </div>
            <div class="fun-fact-content">
                <div class="fun-fact-value">{{ fun_facts.busiest_day }}</div>
                <div class="fun-fact-label">Busiest week of the year</div>
                {% if fun_facts.busiest_day_count %}
                <div class="fun-fact-detail">{{ fun_facts.busiest_day_count }} PRs opened</div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        {% if fun_facts.total_comments is defined and fun_facts.total_comments > 0 %}
        <div class="fun-fact-card">
            <div class="fun-fact-icon">
                <svg width="32" height="32" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3z"/>
                    <path d="M9 2.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3z"/>
                </svg>
            </div>
            <div class="fun-fact-content">
                <div class="fun-fact-value">{{ fun_facts.total_comments | format_number }}</div>
                <div class="fun-fact-label">Comments posted</div>
            </div>
        </div>
        {% endif %}

        {% if not fun_facts.busiest_day and (not fun_facts.total_comments or fun_facts.total_comments == 0) %}
        <div class="fun-fact-card" style="grid-column: 1 / -1; text-align: center;">
            <div class="fun-fact-content">
                <div class="fun-fact-value" style="font-size: 1.2rem; color: var(--text-secondary);">
                    Limited statistics available
                </div>
                <div class="fun-fact-label">
                    Some activity metrics require additional data collection to display
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<section class="awards-cta-section">
    <div class="cta-banner">
        <h2>Keep Up the Great Work!</h2>
        <p>These awards celebrate the amazing contributions made in {{ config.github.windows.year }}. Here's to an even better year ahead!</p>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="assets/js/awards.js"></script>
<script>
    // Initialize awards tabs
    if (typeof initAwardsTabs === 'function') {
        initAwardsTabs();
    }
</script>
{% endblock %}
